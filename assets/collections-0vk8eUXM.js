import{d as $,o as d,k as p,c as x,y as f,w as S,b as w,t as g,i as _,e as i,z as k,u as C,A as T,B as A,l as u,F as b,r as m,v,x as B}from"./index-vL_oJ4Kp.js";const P={class:"utility-section"},I=["innerHTML"],E={class:"utility-section__content"},q=$({__name:"UtilitySection",props:{title:{},titleHeadingLevel:{default:"h3"},description:{}},setup(t){return(e,a)=>(d(),p("section",P,[(d(),x(f(t.titleHeadingLevel),{class:"utility-section__title"},{default:S(()=>[w(g(t.title),1)]),_:1})),t.description?(d(),p("p",{key:0,class:"utility-section__description",innerHTML:t.description},null,8,I)):_("",!0),i("div",E,[k(e.$slots,"default")])]))}}),L={class:"scope-selection"},M={class:"scope-selection__label"},F={class:"scope-selection__checkbox-option"},H=["disabled","aria-label"],z={key:0,class:"scope-selection__scope-group"},K={class:"scope-selection__scope-options"},N=["value","checked","onChange","disabled","aria-label"],V={key:1,class:"scope-selection__scope-group"},D={class:"scope-selection__scope-options"},O=["value","checked","onChange","disabled","aria-label"],U={key:2,class:"scope-selection__empty-scopes"},j=$({__name:"ScopeSelection",props:{disabled:{type:Boolean},ariaContext:{}},setup(t){const e=C(),a=v({get:()=>e.selectedScopes.blog,set:r=>{e.selectedScopes={...e.selectedScopes,blog:r}}}),l=v(()=>`${e.selectedScopes.blog?"exclude":"include"} blog posts`);function n(r){const o=e.selectedScopes.pageTypes.indexOf(r)>-1?e.selectedScopes.pageTypes.filter(h=>h!==r):[...e.selectedScopes.pageTypes,r];e.selectedScopes={...e.selectedScopes,pageTypes:o}}function s(r){const o=e.selectedScopes.collectionKeys.indexOf(r)>-1?e.selectedScopes.collectionKeys.filter(h=>h!==r):[...e.selectedScopes.collectionKeys,r];e.selectedScopes={...e.selectedScopes,collectionKeys:o}}return(r,c)=>(d(),p("fieldset",L,[i("legend",M,[k(r.$slots,"legend",{},()=>[c[1]||(c[1]=w("Scopes",-1))],!0)]),i("label",F,[T(i("input",{type:"checkbox","onUpdate:modelValue":c[0]||(c[0]=o=>a.value=o),disabled:t.disabled,"aria-label":l.value},null,8,H),[[A,a.value]]),c[2]||(c[2]=i("span",null,"Blog",-1))]),u(e).pageTypes.length>0?(d(),p("div",z,[c[3]||(c[3]=i("div",{class:"scope-selection__scope-group-title"},"Page Types",-1)),i("div",K,[(d(!0),p(b,null,m(u(e).pageTypes,o=>(d(),p("label",{key:o,class:"scope-selection__checkbox-option"},[i("input",{type:"checkbox",value:o,checked:u(e).selectedScopes.pageTypes.includes(o),onChange:h=>n(o),disabled:t.disabled,"aria-label":`Include ${o} pages in ${t.ariaContext}`},null,40,N),i("span",null,g(o),1)]))),128))])])):_("",!0),u(e).collectionKeys.length>0?(d(),p("div",V,[c[4]||(c[4]=i("div",{class:"scope-selection__scope-group-title"},"Collection Keys",-1)),i("div",D,[(d(!0),p(b,null,m(u(e).collectionKeys,o=>(d(),p("label",{key:o,class:"scope-selection__checkbox-option"},[i("input",{type:"checkbox",value:o,checked:u(e).selectedScopes.collectionKeys.includes(o),onChange:h=>s(o),disabled:t.disabled,"aria-label":`Include ${o} collection in ${t.ariaContext}`},null,40,O),i("span",null,g(o),1)]))),128))])])):_("",!0),u(e).pageTypes.length===0&&u(e).collectionKeys.length===0?(d(),p("div",U,[...c[5]||(c[5]=[i("p",null,"No page types or collection keys configured. Configure them in API Configuration above.",-1)])])):_("",!0)]))}}),G=B(j,[["__scopeId","data-v-453ca2d2"]]);async function y(t,e=3){let a=null;for(let l=1;l<=e;l++)try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(n){a=n,l<e&&await new Promise(s=>setTimeout(s,1e3*l))}throw a}async function J(t){const e=[];let a=1,l=!0;for(;l;){const n=`https://api.buttercms.com/v2/pages/${t.pageType}/?auth_token=${t.token}&page=${a}&page_size=100&levels=5&alt_media_text=1${t.preview?"&preview=1":""}`;try{const s=await y(n);s.data&&Array.isArray(s.data)&&s.data.length>0?(e.push(...s.data),l=s.meta?.next_page!==null,a++):l=!1}catch(s){throw new Error(`Failed to fetch page ${t.pageType}: ${s.message}`)}}return e}async function Q(t){const e=[];let a=1,l=!0;for(;l;){const n=`https://api.buttercms.com/v2/posts/?auth_token=${t.token}&page=${a}&page_size=100${t.preview?"&preview=1":""}`;try{const s=await y(n);s.data&&Array.isArray(s.data)&&s.data.length>0?(e.push(...s.data),l=s.meta?.next_page!==null,a++):l=!1}catch(s){throw new Error(`Failed to fetch posts: ${s.message}`)}}return e}async function R(t){const e=[];let a=1,l=!0;for(;l;){const n=`https://api.buttercms.com/v2/content/${t.collectionType}/?auth_token=${t.token}&page=${a}&page_size=100&levels=5&alt_media_text=1${t.preview?"&preview=1":""}`;try{const s=await y(n);s.data&&Array.isArray(s.data[t.collectionType])&&s.data[t.collectionType].length>0?(e.push(...s.data[t.collectionType]),l=s.meta?.next_page!==null,a++):l=!1}catch(s){throw new Error(`Failed to fetch collection ${t.collectionType}: ${s.message}`)}}return e}export{G as S,q as _,Q as a,R as b,J as g};

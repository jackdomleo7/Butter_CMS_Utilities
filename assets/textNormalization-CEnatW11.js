import{d as f,o as p,k as d,c as k,y as x,w as S,b as $,t as _,i as h,e as r,z as w,u as C,A as T,B as A,l as u,F as b,r as m,v,x as B}from"./index-DLZBvp8a.js";const M={class:"utility-section"},P=["innerHTML"],E={class:"utility-section__content"},q=f({__name:"UtilitySection",props:{title:{},titleHeadingLevel:{default:"h3"},description:{}},setup(t){return(e,n)=>(p(),d("section",M,[(p(),k(x(t.titleHeadingLevel),{class:"utility-section__title"},{default:S(()=>[$(_(t.title),1)]),_:1})),t.description?(p(),d("p",{key:0,class:"utility-section__description",innerHTML:t.description},null,8,P)):h("",!0),r("div",E,[w(e.$slots,"default")])]))}}),I={class:"scope-selection"},L={class:"scope-selection__label"},F={class:"scope-selection__checkbox-option"},H=["disabled","aria-label"],D={key:0,class:"scope-selection__scope-group"},K={class:"scope-selection__scope-options"},N=["value","checked","onChange","disabled","aria-label"],V={key:1,class:"scope-selection__scope-group"},z={class:"scope-selection__scope-options"},O=["value","checked","onChange","disabled","aria-label"],U={key:2,class:"scope-selection__empty-scopes"},W=f({__name:"ScopeSelection",props:{disabled:{type:Boolean},ariaContext:{}},setup(t){const e=C(),n=v({get:()=>e.selectedScopes.blog,set:a=>{e.selectedScopes={...e.selectedScopes,blog:a}}}),l=v(()=>`${e.selectedScopes.blog?"exclude":"include"} blog posts`);function c(a){const o=e.selectedScopes.pageTypes.indexOf(a)>-1?e.selectedScopes.pageTypes.filter(g=>g!==a):[...e.selectedScopes.pageTypes,a];e.selectedScopes={...e.selectedScopes,pageTypes:o}}function s(a){const o=e.selectedScopes.collectionKeys.indexOf(a)>-1?e.selectedScopes.collectionKeys.filter(g=>g!==a):[...e.selectedScopes.collectionKeys,a];e.selectedScopes={...e.selectedScopes,collectionKeys:o}}return(a,i)=>(p(),d("fieldset",I,[r("legend",L,[w(a.$slots,"legend",{},()=>[i[1]||(i[1]=$("Scopes",-1))],!0)]),r("label",F,[T(r("input",{type:"checkbox","onUpdate:modelValue":i[0]||(i[0]=o=>n.value=o),disabled:t.disabled,"aria-label":l.value},null,8,H),[[A,n.value]]),i[2]||(i[2]=r("span",null,"Blog",-1))]),u(e).pageTypes.length>0?(p(),d("div",D,[i[3]||(i[3]=r("div",{class:"scope-selection__scope-group-title"},"Page Types",-1)),r("div",K,[(p(!0),d(b,null,m(u(e).pageTypes,o=>(p(),d("label",{key:o,class:"scope-selection__checkbox-option"},[r("input",{type:"checkbox",value:o,checked:u(e).selectedScopes.pageTypes.includes(o),onChange:g=>c(o),disabled:t.disabled,"aria-label":`Include ${o} pages in ${t.ariaContext}`},null,40,N),r("span",null,_(o),1)]))),128))])])):h("",!0),u(e).collectionKeys.length>0?(p(),d("div",V,[i[4]||(i[4]=r("div",{class:"scope-selection__scope-group-title"},"Collection Keys",-1)),r("div",z,[(p(!0),d(b,null,m(u(e).collectionKeys,o=>(p(),d("label",{key:o,class:"scope-selection__checkbox-option"},[r("input",{type:"checkbox",value:o,checked:u(e).selectedScopes.collectionKeys.includes(o),onChange:g=>s(o),disabled:t.disabled,"aria-label":`Include ${o} collection in ${t.ariaContext}`},null,40,O),r("span",null,_(o),1)]))),128))])])):h("",!0),u(e).pageTypes.length===0&&u(e).collectionKeys.length===0?(p(),d("div",U,[...i[5]||(i[5]=[r("p",null,"No page types or collection keys configured. Configure them in API Configuration above.",-1)])])):h("",!0)]))}}),G=B(W,[["__scopeId","data-v-453ca2d2"]]);async function y(t,e=3){let n=null;for(let l=1;l<=e;l++)try{const c=await fetch(t);if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);return await c.json()}catch(c){n=c,l<e&&await new Promise(s=>setTimeout(s,1e3*l))}throw n}async function J(t){const e=[];let n=1,l=!0;for(;l;){const c=`https://api.buttercms.com/v2/pages/${t.pageType}/?auth_token=${t.token}&page=${n}&page_size=100&levels=5&alt_media_text=1${t.preview?"&preview=1":""}`;try{const s=await y(c);s.data&&Array.isArray(s.data)&&s.data.length>0?(e.push(...s.data),l=s.meta?.next_page!==null,n++):l=!1}catch(s){throw new Error(`Failed to fetch page ${t.pageType}: ${s.message}`)}}return e}async function Q(t){const e=[];let n=1,l=!0;for(;l;){const c=`https://api.buttercms.com/v2/posts/?auth_token=${t.token}&page=${n}&page_size=100${t.preview?"&preview=1":""}`;try{const s=await y(c);s.data&&Array.isArray(s.data)&&s.data.length>0?(e.push(...s.data),l=s.meta?.next_page!==null,n++):l=!1}catch(s){throw new Error(`Failed to fetch posts: ${s.message}`)}}return e}async function R(t){const e=[];let n=1,l=!0;for(;l;){const c=`https://api.buttercms.com/v2/content/${t.collectionType}/?auth_token=${t.token}&page=${n}&page_size=100&levels=5&alt_media_text=1${t.preview?"&preview=1":""}`;try{const s=await y(c);s.data&&Array.isArray(s.data[t.collectionType])&&s.data[t.collectionType].length>0?(e.push(...s.data[t.collectionType]),l=s.meta?.next_page!==null,n++):l=!1}catch(s){throw new Error(`Failed to fetch collection ${t.collectionType}: ${s.message}`)}}return e}function X(t){return t.replace(/&quot;/gi,'"').replace(/&apos;/gi,"'").replace(/&#39;/gi,"'").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/&pound;/gi,"£").replace(/&euro;/gi,"€").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&ndash;/gi,"-").replace(/&mdash;/gi,"-").replace(/[\u2013\u2014]/g,"-").replace(/&nbsp;/gi," ").replace(/\u00A0/g," ").replace(/\s+/g," ")}function Y(t,e,n,l=100){const c=Math.max(0,e-l),s=Math.min(t.length,e+n+l);let a=t.substring(c,s);return c>0&&(a="..."+a),s<t.length&&(a=a+"..."),a}export{G as S,q as _,Q as a,R as b,Y as c,J as g,X as n};
